\documentclass[12pt]{report}
\usepackage{lingmacros}
\usepackage{tree-dvips}
\usepackage{listings}
\usepackage{tabulary}

\begin{document}

\section*{Report Labwork III}

Prepare for Labwork:

{\small
\enumsentence{Clone employees database from Github}}
{\small
\enumsentence{Create Fork from Github repository}}
{\small
\enumsentence{Install Mysql}}

\subsection*{I: All info of all employees}

\begin{lstlisting}[language=sql]
Command: SELECT * FROM `employees`
\end{lstlisting}
\textbf{Output:}

\begin{lstlisting}[language=sql]

| 499990 | 1963-11-03 | Khaled         | Kohling          | M      | 1985-10-10 |
| 499991 | 1962-02-26 | Pohua          | Sichman          | F      | 1989-01-12 |
| 499992 | 1960-10-12 | Siamak         | Salverda         | F      | 1987-05-10 |
| 499993 | 1963-06-04 | DeForest       | Mullainathan     | M      | 1997-04-07 |
| 499994 | 1952-02-26 | Navin          | Argence          | F      | 1990-04-24 |
| 499995 | 1958-09-24 | Dekang         | Lichtner         | F      | 1993-01-12 |
| 499996 | 1953-03-07 | Zito           | Baaz             | M      | 1990-09-27 |
| 499997 | 1961-08-03 | Berhard        | Lenart           | M      | 1986-04-21 |
| 499998 | 1956-09-05 | Patricia       | Breugel          | M      | 1993-10-13 |
| 499999 | 1958-05-01 | Sachin         | Tsukuda          | M      | 1997-11-30 |
+--------+------------+----------------+------------------+--------+------------+
300024 rows in set (0.35 sec)

\end{lstlisting}


\subsection*{II: All info of all departments}

\begin{lstlisting}[language=sql]
Command: SELECT * FROM `departments`;
\end{lstlisting}
\textbf{Output:}

\begin{lstlisting}[language=sql]

+---------+--------------------+
| dept_no | dept_name          |
+---------+--------------------+
| d009    | Customer Service   |
| d005    | Development        |
| d002    | Finance            |
| d003    | Human Resources    |
| d001    | Marketing          |
| d004    | Production         |
| d006    | Quality Management |
| d008    | Research           |
| d007    | Sales              |
+---------+--------------------+
9 rows in set (0.00 sec)

\end{lstlisting}

\subsection*{III: Full names of all employees}

\begin{lstlisting}[language=sql]
Command: SELECT CONCAT(first_name,' ', last_name) AS fullname  FROM `employees`;
\end{lstlisting}
\textbf{Output:}

\begin{lstlisting}[language=sql]

| DeForest Mullainathan          |
| Navin Argence                  |
| Dekang Lichtner                |
| Zito Baaz                      |
| Berhard Lenart                 |
| Patricia Breugel               |
| Sachin Tsukuda                 |
+--------------------------------+
300024 rows in set (0.20 sec)

\end{lstlisting}


\subsection*{IV: Names of all departments}

\begin{lstlisting}[language=sql]
Command: SELECT dept_name FROM `departments`;
\end{lstlisting}
\textbf{Output:}

\begin{lstlisting}[language=sql]
+--------------------+
| dept_name          |
+--------------------+
| Customer Service   |
| Development        |
| Finance            |
| Human Resources    |
| Marketing          |
| Production         |
| Quality Management |
| Research           |
| Sales              |
+--------------------+
9 rows in set (0.01 sec)
\end{lstlisting}


\subsection*{V: Full names of employees working in "Sales" department}

\begin{lstlisting}[language=sql]
Command: SELECT CONCAT(first_name,' ', last_name) AS fullname  FROM `employees` t1 JOIN `dept_emp` t2 ON t1.emp_no=t2.emp_no JOIN `departments` t3 ON t2.dept_no=t3.dept_no WHERE t3.`dept_name` = 'Sales';
\end{lstlisting}
\textbf{Output:}

\begin{lstlisting}[language=sql]

| Christ Murtagh                |
| Youpyo Perfilyeva             |
| Leszek Pulkowski              |
| Gaetan Veldwijk               |
| Mihalis Crabtree              |
| Bangqing Bodoff               |
| Guozhong Felder               |
| Gino Usery                    |
| Nathan Ranta                  |
| Rimli Dusink                  |
| Bangqing Kleiser              |
+-------------------------------+
52245 rows in set (0.27 sec)


\end{lstlisting}



\subsection*{VI: Full names of male employees working in "Finance" department}

\begin{lstlisting}[language=sql]
Command: SELECT CONCAT(first_name,' ', last_name) AS fullname  FROM `employees` t1 JOIN `dept_emp` t2 ON t1.emp_no=t2.emp_no JOIN `departments` t3 ON t2.dept_no=t3.dept_no WHERE t3.`dept_name` = 'Finance' AND t1.gender='M';
\end{lstlisting}
\textbf{Output:}
\begin{lstlisting}[language=sql]

| Ymte Potthoff                |
| Nagui Stamatiou              |
| Bernd Gluchowski             |
| Phillip Panienski            |
| Sastry Szmurlo               |
| Jacopo Hasham                |
| Moon Pleszkun                |
| Hercules Porotnikoff         |
| Shaz Bierbaum                |
| Masali Chorvat               |
| Keiichiro Lindqvist          |
| Patricia Breugel             |
+------------------------------+
10331 rows in set (0.04 sec)
\end{lstlisting}

\subsection*{VI: Full names of male employees working in "Finance" department}

\begin{lstlisting}[language=sql]
Command: SELECT CONCAT(first_name,' ', last_name) AS fullname  FROM `employees` t1 JOIN `dept_emp` t2 ON t1.emp_no=t2.emp_no JOIN `departments` t3 ON t2.dept_no=t3.dept_no WHERE t3.`dept_name` = 'Marketing' AND t1.gender='F';
\end{lstlisting}
\textbf{Output:}
\begin{lstlisting}[language=sql]
| Breannda Gajiwala           |
| Vesna Attimonelli           |
| Kinh Sommer                 |
| Turgut Levasseur            |
| Gopalakrishnan Maierhofer   |
| Moriyoshi Pusterhofer       |
| JiYoung Coney               |
| Adhemar Gist                |
| Tonia Butner                |
| Siamak Salverda             |
+-----------------------------+
8037 rows in set (0.06 sec)

\end{lstlisting}

\subsection*{VII: Full names of employees who have the same last name astheir manager}

\begin{lstlisting}[language=sql]
Command: SELECT CONCAT(first_name,' ',last_name) AS Fullname FROM employees e1 WHERE e1.last_name IN (SELECT last_name FROM employees e2 JOIN dept_manager dm ON e2.emp_no=dm.emp_no);

\end{lstlisting}
\textbf{Output:}
\begin{lstlisting}[language=sql]

| Abdelkader Ghazalie        |
| Gudjon Hagimont            |
| Padma Hofmeyr              |
| Suvo Minakawa              |
| Xiaoshan Sigstam           |
| Mong Staelin               |
| Parto Kambil               |
| Martine Markovitch         |
| Zine Ghazalie              |
| Vasilis Kaelbling          |
| Xiadong Hofmeyr            |
| Hidde Alpin                |
| Heekeun Weedman            |
+----------------------------+
4403 rows in set (0.74 sec)

\end{lstlisting}


\subsection*{VIII: Full names of managers who have been doing the job twice}

\begin{lstlisting}[language=sql]
Command: SELECT COUNT(CONCAT(first_name,' ',last_name)) AS Jobs ,CONCAT(first_name,' ',last_name) AS Fullname FROM employees e1 JOIN titles t ON e1.emp_no=t.emp_no JOIN dept_manager dm ON e1.emp_no=dm.emp_no GROUP BY first_name,last_name
;

\end{lstlisting}
\textbf{Output:}
\begin{lstlisting}[language=sql]
+------+-----------------------+
| Jobs | Fullname              |
+------+-----------------------+
|    2 | Arie Staelin          |
|    2 | DeForest Hagimont     |
|    2 | Dung Pesch            |
|    2 | Ebru Alpin            |
|    2 | Hauke Zhang           |
|    2 | Hilary Kambil         |
|    2 | Isamu Legleitner      |
|    2 | Karsten Sigstam       |
|    2 | Krassimir Wegerle     |
|    2 | Leon DasSarma         |
|    2 | Margareta Markovitch  |
|    3 | Marjo Giarratana      |
|    2 | Oscar Ghazalie        |
|    2 | Peternela Onuegbe     |
|    2 | Przemyslawa Kaelbling |
|    3 | Rosine Cools          |
|    3 | Rutger Hofmeyr        |
|    3 | Sanjoy Quadeer        |
|    3 | Shem Kieras           |
|    2 | Shirish Ossenbruggen  |
|    2 | Tonny Butterworth     |
|    2 | Vishwani Minakawa     |
|    3 | Xiaobin Spinelli      |
|    2 | Yuchang Weedman       |
+------+-----------------------+
24 rows in set (0.00 sec)

\end{lstlisting}


\subsection*{IX: Full names of employees who was paid more than 100.000}

\begin{lstlisting}[language=sql]
Command: SELECT DISTINCT(CONCAT(first_name,' ',last_name)) FROM employees e RIGHT JOIN salaries s ON e.emp_no=s.emp_no WHERE s.salary > 100000;
\end{lstlisting}
\textbf{Output:}
\begin{lstlisting}[language=sql]

| Akeel Baez                         |
| Armond Fraisse                     |
| Christoph Schneeberger             |
| Mong Usdin                         |
| Aloke Wuwongse                     |
| Masako Angiulli                    |
| Christ Murtagh                     |
| Youpyo Perfilyeva                  |
| Leszek Pulkowski                   |
| Danai Hedayat                      |
| Guozhong Felder                    |
| Gino Usery                         |
| Nathan Ranta                       |
| Bangqing Kleiser                   |
+------------------------------------+
18925 rows in set (1.20 sec)

\end{lstlisting}


\subsection*{X: Names of all departments that have employees paid morethan 100.000}

\begin{lstlisting}[language=sql]
Command: SELECT DISTINCT(dept_name) FROM employees e JOIN salaries s ON e.emp_no=s.emp_no JOIN dept_emp de ON de.emp_no=e.emp_no JOIN departments d ON d.dept_no=de.dept_no WHERE s.salary>100000;
\end{lstlisting}
\textbf{Output:}
\begin{lstlisting}[language=sql]
+--------------------+
| dept_name          |
+--------------------+
| Customer Service   |
| Development        |
| Finance            |
| Human Resources    |
| Marketing          |
| Production         |
| Quality Management |
| Research           |
| Sales              |
+--------------------+
9 rows in set (0.01 sec)

\end{lstlisting}

\end{document}